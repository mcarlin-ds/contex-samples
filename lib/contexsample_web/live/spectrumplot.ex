defmodule ContexSampleWeb.SpectrumPlotLive do
  use Phoenix.LiveView
  use Phoenix.HTML

  import ContexSampleWeb.Shared

  alias Contex.{LinePlot, PointPlot, Dataset, Plot}

  @cur_points [
    -6.98483671875,
    -6.9142828125,
    -7.07890859375,
    -7.0083546875,
    -6.65558515625,
    -6.42040546875,
    -6.46744140625,
    -6.46744140625,
    -6.3498515625,
    -6.27929765625,
    -6.490959375,
    -6.3968875,
    -6.490959375,
    -6.302815625,
    -6.3968875,
    -6.3498515625,
    -6.679103125,
    -6.58503125,
    -6.42040546875,
    -6.27929765625,
    -5.9735640625,
    -5.8794921875,
    -5.76190234375,
    -6.09115390625,
    -6.56151328125,
    -6.56151328125,
    -6.679103125,
    -6.32633359375,
    -6.23226171875,
    -6.09115390625,
    -6.58503125,
    -6.2557796875,
    -5.5972765625,
    -5.29154296875,
    -5.3150609375,
    -5.4091328125,
    -5.268025,
    -4.86821953125,
    -4.9387734375,
    -5.0328453125,
    -5.0328453125,
    -5.1269171875,
    -4.86821953125,
    -4.35082421875,
    -4.20971640625,
    -4.5154499999999995,
    -4.53896796875,
    -4.58600390625,
    -4.49193203125,
    -4.8447015625,
    -4.72711171875,
    -4.82118359375,
    -4.8447015625,
    -4.797665625,
    -4.3743421875,
    -4.06860859375,
    -4.32730625,
    -4.7506296875,
    -4.9387734375,
    -4.91525546875,
    -5.3385789062499995,
    -5.0328453125,
    -4.9387734375,
    -4.5624859375,
    -4.8917375,
    -5.268025,
    -5.38561484375,
    -5.268025,
    -5.362096875,
    -4.8917375,
    -4.72711171875,
    -4.58600390625,
    -4.5154499999999995,
    -4.985809375,
    -4.7506296875,
    -5.0328453125,
    -5.173953125,
    -5.05636328125,
    -4.5154499999999995,
    -4.5154499999999995,
    -4.70359375,
    -5.05636328125,
    -5.15043515625,
    -5.0328453125,
    -4.9387734375,
    -5.05636328125,
    -5.10339921875,
    -5.00932734375,
    -5.05636328125,
    -5.1269171875,
    -4.9387734375,
    -4.86821953125,
    -5.05636328125,
    -4.8447015625,
    -4.96229140625,
    -5.29154296875,
    -5.738384375,
    -5.85597421875,
    -5.6913484375,
    -5.2209890625,
    -5.1269171875,
    -5.362096875,
    -5.29154296875,
    -5.0328453125,
    -5.173953125,
    -5.10339921875,
    -5.3150609375,
    -5.738384375,
    -6.23226171875,
    -5.43265078125,
    -5.3150609375,
    -5.47968671875,
    -6.1617078124999995,
    -5.85597421875,
    -5.76190234375,
    -6.27929765625,
    -5.66783046875,
    -5.62079453125,
    -5.5032046875,
    -5.8794921875,
    -6.0676359374999995,
    -6.3968875,
    -6.3968875,
    -6.0206,
    -5.7854203125,
    -5.38561484375,
    -5.3385789062499995,
    -5.0328453125,
    -4.70359375,
    -5.00932734375,
    -5.29154296875,
    -5.43265078125,
    -5.07988125,
    -5.0328453125,
    -4.985809375,
    -5.76190234375,
    -5.83245625,
    -5.6913484375,
    -5.83245625,
    -5.71486640625,
    -5.45616875,
    -5.268025,
    -5.95004609375,
    -5.83245625,
    -5.90301015625,
    -5.4091328125,
    -5.3385789062499995,
    -5.6913484375,
    -5.5032046875,
    -5.76190234375,
    -5.80893828125,
    -6.0206,
    -6.58503125,
    -6.51447734375,
    -6.302815625,
    -6.09115390625,
    -5.99708203125,
    -6.3968875,
    -6.09115390625,
    -6.0676359374999995,
    -5.95004609375,
    -5.5972765625,
    -5.52672265625,
    -5.43265078125,
    -5.71486640625,
    -5.76190234375,
    -6.0676359374999995,
    -5.926528125,
    -5.8794921875,
    -5.5972765625,
    -5.3150609375,
    -5.4091328125,
    -5.43265078125,
    -5.3150609375,
    -5.6443125,
    -5.95004609375,
    -6.13818984375,
    -6.04411796875,
    -6.1617078124999995,
    -5.62079453125,
    -5.57375859375,
    -5.5972765625,
    -5.173953125,
    -5.15043515625,
    -5.8794921875,
    -6.13818984375,
    -6.2557796875,
    -6.114671875,
    -5.90301015625,
    -6.09115390625,
    -5.85597421875,
    -5.738384375,
    -5.90301015625,
    -5.5972765625,
    -5.5972765625,
    -5.8794921875,
    -6.27929765625,
    -5.85597421875,
    -5.926528125,
    -6.3968875,
    -6.65558515625,
    -6.27929765625,
    -5.95004609375,
    -5.6913484375,
    -5.52672265625,
    -5.57375859375,
    -5.80893828125,
    -5.8794921875,
    -5.71486640625,
    -5.52672265625,
    -5.52672265625,
    -5.8794921875,
    -6.0206,
    -5.7854203125,
    -6.2557796875,
    -6.23226171875,
    -6.09115390625,
    -6.09115390625,
    -6.3968875,
    -6.18522578125,
    -6.74965703125,
    -6.4439234375,
    -6.74965703125,
    -6.7261390625,
    -6.74965703125,
    -6.773175,
    -6.7261390625,
    -6.6320671875,
    -6.51447734375,
    -6.18522578125,
    -6.114671875,
    -6.09115390625,
    -6.20874375,
    -6.42040546875,
    -6.04411796875,
    -5.8794921875,
    -6.18522578125,
    -6.2557796875,
    -6.04411796875,
    -6.37336953125,
    -6.60854921875,
    -6.3968875,
    -6.23226171875,
    -5.8794921875,
    -6.13818984375,
    -6.0206,
    -6.13818984375,
    -6.490959375,
    -6.8907648437499995,
    -7.0083546875,
    -7.1964984375,
    -6.84372890625,
    -6.93780078125,
    -6.5379953125,
    -5.71486640625,
    -5.71486640625,
    -6.302815625,
    -6.490959375,
    -6.679103125,
    -6.490959375,
    -6.3498515625,
    -6.490959375,
    -6.98483671875,
    -7.055390625,
    -6.4439234375,
    -6.5379953125,
    -6.679103125,
    -6.84372890625,
    -6.74965703125,
    -6.27929765625,
    -6.18522578125,
    -6.58503125,
    -6.3498515625,
    -6.13818984375,
    -5.99708203125,
    -6.04411796875,
    -6.46744140625,
    -6.3968875,
    -6.32633359375,
    -6.4439234375,
    -6.773175,
    -7.22001640625,
    -7.03187265625,
    -7.1494625,
    -7.1964984375,
    -7.0083546875,
    -6.5379953125,
    -6.46744140625,
    -6.23226171875,
    -6.302815625,
    -6.42040546875,
    -6.13818984375,
    -6.46744140625,
    -6.58503125,
    -6.8907648437499995,
    -6.96131875,
    -6.74965703125,
    -6.74965703125,
    -6.70262109375,
    -7.03187265625,
    -7.0083546875,
    -6.60854921875,
    -6.7261390625,
    -6.60854921875,
    -6.65558515625,
    -6.20874375,
    -6.1617078124999995,
    -6.1617078124999995,
    -6.32633359375,
    -6.51447734375,
    -6.7966929687499995,
    -6.46744140625,
    -6.58503125,
    -6.46744140625,
    -6.42040546875,
    -6.490959375,
    -6.679103125,
    -6.74965703125,
    -6.9142828125,
    -6.27929765625,
    -6.58503125,
    -6.773175,
    -6.7966929687499995,
    -6.65558515625,
    -6.32633359375,
    -6.27929765625,
    -6.23226171875,
    -6.3498515625,
    -6.6320671875,
    -6.70262109375,
    -6.51447734375,
    -6.3968875,
    -6.7966929687499995,
    -6.51447734375,
    -6.2557796875,
    -6.56151328125,
    -6.0676359374999995,
    -6.27929765625,
    -6.18522578125,
    -6.27929765625,
    -6.56151328125,
    -6.56151328125,
    -6.679103125,
    -6.42040546875,
    -6.70262109375,
    -6.2557796875,
    -6.20874375,
    -6.20874375,
    -6.18522578125,
    -6.0676359374999995,
    -6.60854921875,
    -6.679103125,
    -6.58503125,
    -6.46744140625,
    -6.27929765625,
    -6.679103125,
    -6.8907648437499995,
    -6.46744140625,
    -6.5379953125,
    -6.20874375,
    -6.18522578125,
    -6.302815625,
    -6.8907648437499995,
    -6.867246875,
    -6.8202109375,
    -6.6320671875,
    -6.3968875,
    -5.85597421875,
    -6.114671875,
    -6.20874375,
    -6.46744140625,
    -6.8907648437499995,
    -6.4439234375,
    -6.58503125,
    -6.3498515625,
    -6.27929765625,
    -6.490959375,
    -6.70262109375,
    -6.490959375,
    -6.3498515625,
    -6.773175,
    -6.8907648437499995,
    -6.96131875,
    -6.8907648437499995,
    -6.867246875,
    -6.60854921875,
    -6.490959375,
    -6.2557796875,
    -6.42040546875,
    -6.74965703125,
    -6.3498515625,
    -6.09115390625,
    -6.13818984375,
    -6.32633359375,
    -6.27929765625,
    -6.51447734375,
    -6.679103125,
    -6.6320671875,
    -7.07890859375,
    -7.1494625,
    -6.6320671875,
    -6.96131875,
    -6.70262109375,
    -6.490959375,
    -6.13818984375,
    -6.51447734375,
    -6.42040546875,
    -6.32633359375,
    -6.09115390625,
    -6.0676359374999995,
    -6.302815625,
    -6.7261390625,
    -6.84372890625,
    -7.03187265625,
    -7.0083546875,
    -6.7261390625,
    -6.3968875,
    -6.3498515625,
    -6.18522578125,
    -6.65558515625,
    -6.56151328125,
    -6.65558515625,
    -6.56151328125,
    -6.6320671875,
    -6.773175,
    -6.93780078125,
    -6.96131875,
    -6.56151328125,
    -6.2557796875,
    -6.46744140625,
    -6.23226171875,
    -5.76190234375,
    -6.13818984375,
    -6.27929765625,
    -6.42040546875,
    -6.65558515625,
    -6.74965703125,
    -6.32633359375,
    -6.0206,
    -6.09115390625,
    -6.3498515625,
    -6.60854921875,
    -7.055390625,
    -6.60854921875,
    -6.2557796875,
    -5.99708203125,
    -6.114671875,
    -6.2557796875,
    -6.679103125,
    -5.99708203125,
    -6.20874375,
    -6.23226171875,
    -6.13818984375,
    -5.95004609375,
    -5.9735640625,
    -5.95004609375,
    -6.18522578125,
    -5.52672265625,
    -4.20971640625,
    -1.57570390625,
    2.6340125,
    6.70262109375,
    9.47774140625,
    12.7467390625,
    15.6629671875,
    18.908446875,
    21.1191359375,
    22.7183578125,
    24.0353640625,
    25.77569375,
    26.83400234375,
    27.7982390625,
    28.38618828125,
    29.27987109375,
    30.0559640625,
    30.22058984375,
    30.29114375,
    30.26762578125,
    30.22058984375,
    30.5263234375,
    30.855574999999998,
    30.9966828125,
    31.2788984375,
    31.0907546875,
    31.06723671875,
    30.97316484375,
    30.855574999999998,
    30.92612890625,
    31.1848265625,
    31.325934375,
    31.58463203125,
    31.702221875,
    31.67870390625,
    31.3729703125,
    31.5611140625,
    31.490560156249998,
    31.44352421875,
    31.490560156249998,
    31.20834453125,
    31.06723671875,
    30.92612890625,
    30.83205703125,
    31.0907546875,
    30.855574999999998,
    30.855574999999998,
    30.92612890625,
    30.45576953125,
    30.40873359375,
    30.59687734375,
    30.7144671875,
    31.04371875,
    31.325934375,
    31.77277578125,
    31.2788984375,
    30.9966828125,
    31.53759609375,
    31.6551859375,
    31.39648828125,
    31.1848265625,
    30.69094921875,
    30.66743125,
    30.83205703125,
    30.9026109375,
    31.114272656249998,
    31.114272656249998,
    31.04371875,
    31.06723671875,
    30.949646875,
    31.114272656249998,
    31.20834453125,
    31.02020078125,
    30.40873359375,
    30.69094921875,
    30.9026109375,
    30.6203953125,
    30.9026109375,
    30.97316484375,
    30.855574999999998,
    30.573359375,
    30.573359375,
    31.20834453125,
    31.53759609375,
    31.16130859375,
    30.83205703125,
    30.855574999999998,
    30.479287499999998,
    30.40873359375,
    30.45576953125,
    30.50280546875,
    30.59687734375,
    29.6796765625,
    28.95061953125,
    28.5508140625,
    27.53954140625,
    26.622340625,
    25.37588828125,
    24.4116515625,
    22.76539375,
    20.76636640625,
    18.50864140625,
    15.68648515625,
    12.5585953125,
    9.313115625,
    6.56151328125,
    2.70456640625,
    -0.9877546875,
    -3.92750078125,
    -5.24450703125,
    -5.738384375,
    -5.99708203125,
    -6.0206,
    -6.0676359374999995,
    -6.46744140625,
    -6.65558515625,
    -6.60854921875,
    -6.51447734375,
    -6.32633359375,
    -6.09115390625,
    -6.1617078124999995,
    -5.6913484375,
    -5.76190234375,
    -5.7854203125,
    -6.04411796875,
    -6.2557796875,
    -6.490959375,
    -6.58503125,
    -6.42040546875,
    -6.04411796875,
    -6.302815625,
    -6.42040546875,
    -6.32633359375,
    -6.3498515625,
    -6.58503125,
    -7.17298046875,
    -7.1024265625,
    -6.679103125,
    -6.46744140625,
    -6.302815625,
    -6.09115390625,
    -6.37336953125,
    -6.46744140625,
    -6.490959375,
    -6.4439234375,
    -6.4439234375,
    -6.20874375,
    -5.85597421875,
    -6.0676359374999995,
    -6.302815625,
    -6.18522578125,
    -6.20874375,
    -5.95004609375,
    -5.83245625,
    -5.3385789062499995,
    -5.71486640625,
    -5.80893828125,
    -6.0676359374999995,
    -6.2557796875,
    -6.60854921875,
    -7.07890859375,
    -6.37336953125,
    -6.42040546875,
    -6.6320671875,
    -6.56151328125,
    -6.51447734375,
    -6.58503125,
    -6.6320671875,
    -6.37336953125,
    -6.58503125,
    -6.32633359375,
    -6.302815625,
    -6.490959375,
    -6.46744140625,
    -6.70262109375,
    -6.37336953125,
    -6.3968875,
    -6.773175,
    -6.74965703125,
    -6.20874375,
    -6.23226171875,
    -6.302815625,
    -6.70262109375,
    -6.7261390625,
    -6.70262109375,
    -6.3498515625,
    -6.58503125,
    -6.70262109375,
    -6.7261390625,
    -6.58503125,
    -6.1617078124999995,
    -6.09115390625,
    -6.114671875,
    -5.80893828125,
    -5.99708203125,
    -6.0206,
    -6.32633359375,
    -6.74965703125,
    -6.9142828125,
    -6.58503125,
    -6.3968875,
    -6.2557796875,
    -6.20874375,
    -6.60854921875,
    -6.867246875,
    -6.65558515625,
    -6.74965703125,
    -6.46744140625,
    -6.37336953125,
    -5.95004609375,
    -6.18522578125,
    -6.3968875,
    -6.5379953125,
    -6.490959375,
    -6.04411796875,
    -6.20874375,
    -5.173953125,
    -2.4929046875,
    0.68202109375,
    4.3743421875,
    8.11369921875,
    11.54732265625,
    14.392996875,
    16.72127578125,
    18.532159375,
    20.01379140625,
    21.00154609375,
    22.31855234375,
    24.19998984375,
    24.62331328125,
    25.2582984375,
    25.65810390625,
    26.5753046875,
    27.0456640625,
    27.35139765625,
    27.4219515625,
    27.374915625,
    27.35139765625,
    27.44546953125,
    27.374915625,
    27.4219515625,
    27.2338078125,
    27.4689875,
    27.2338078125,
    27.186771874999998,
    27.49250546875,
    27.63361328125,
    27.374915625,
    27.39843359375,
    27.4219515625,
    27.4689875,
    27.49250546875,
    27.374915625,
    27.5160234375,
    27.751203125,
    27.82175703125,
    27.8923109375,
    27.49250546875,
    26.73993046875,
    26.64585859375,
    27.0456640625,
    27.49250546875,
    27.6100953125,
    27.82175703125,
    27.58657734375,
    27.1397359375,
    27.21028984375,
    27.28084375,
    27.39843359375,
    27.16325390625,
    27.2338078125,
    27.06918203125,
    27.28084375,
    27.44546953125,
    27.4689875,
    27.25732578125,
    26.7634484375,
    26.8575203125,
    27.49250546875,
    27.25732578125,
    26.83400234375,
    26.998628125,
    26.78696640625,
    27.21028984375,
    27.39843359375,
    27.58657734375,
    27.8923109375,
    28.15100859375,
    27.91582890625,
    27.16325390625,
    27.06918203125,
    27.16325390625,
    27.35139765625,
    27.39843359375,
    27.68064921875,
    27.58657734375,
    27.72768515625,
    27.35139765625,
    27.1397359375,
    27.4219515625,
    27.49250546875,
    27.44546953125,
    27.563059374999998,
    27.845275,
    27.9863828125,
    27.7041671875,
    27.6100953125,
    28.1745265625,
    28.33915234375,
    28.03341875,
    27.8923109375,
    27.939346875,
    27.82175703125,
    27.5160234375,
    27.0456640625,
    26.78696640625,
    27.16325390625,
    27.25732578125,
    27.28084375,
    27.8923109375,
    28.315634375,
    28.2215625,
    27.7041671875,
    26.9515921875,
    27.4689875,
    27.39843359375,
    27.21028984375,
    27.186771874999998,
    27.35139765625,
    27.11621796875,
    27.374915625,
    27.28084375,
    27.30436171875,
    27.49250546875,
    26.928074218749998,
    27.5160234375,
    27.72768515625,
    27.4219515625,
    27.25732578125,
    27.39843359375,
    27.8923109375,
    28.00990078125,
    27.68064921875,
    27.86879296875,
    27.7982390625,
    27.91582890625,
    27.751203125,
    27.53954140625,
    27.58657734375,
    27.49250546875,
    27.39843359375,
    27.63361328125,
    27.4219515625,
    26.97511015625,
    27.16325390625,
    27.21028984375,
    27.44546953125,
    27.65713125,
    27.7041671875,
    28.00990078125,
    27.8923109375,
    27.53954140625,
    27.4689875,
    27.39843359375,
    27.3278796875,
    27.63361328125,
    27.5160234375,
    27.4689875,
    27.5160234375,
    27.44546953125,
    27.28084375,
    27.845275,
    28.0804546875,
    27.845275,
    27.7041671875,
    27.563059374999998,
    27.751203125,
    28.127490625,
    27.86879296875,
    27.1397359375,
    27.06918203125,
    27.63361328125,
    27.845275,
    27.939346875,
    27.8923109375,
    27.8923109375,
    27.49250546875,
    26.78696640625,
    26.928074218749998,
    27.563059374999998,
    27.1397359375,
    27.02214609375,
    27.02214609375,
    27.0927,
    27.28084375,
    27.44546953125,
    27.4219515625,
    27.0456640625,
    27.4219515625,
    27.96286484375,
    28.05693671875,
    27.49250546875,
    27.751203125,
    28.00990078125,
    27.82175703125,
    27.65713125,
    27.6100953125,
    27.939346875,
    27.63361328125,
    27.39843359375,
    27.1397359375,
    27.16325390625,
    27.4689875,
    27.7041671875,
    27.49250546875,
    27.77472109375,
    27.96286484375,
    27.8923109375,
    27.63361328125,
    27.939346875,
    27.939346875,
    27.939346875,
    27.49250546875,
    27.5160234375,
    27.7982390625,
    27.39843359375,
    26.8575203125,
    27.186771874999998,
    27.53954140625,
    28.0804546875,
    28.15100859375,
    28.3626703125,
    28.15100859375,
    27.845275,
    27.28084375,
    27.53954140625,
    27.751203125,
    28.29211640625,
    28.6448859375,
    27.9863828125,
    27.77472109375,
    28.0804546875,
    27.72768515625,
    27.63361328125,
    27.374915625,
    27.563059374999998,
    27.6100953125,
    27.44546953125,
    27.4219515625,
    27.86879296875,
    27.751203125,
    27.845275,
    27.96286484375,
    27.44546953125,
    27.58657734375,
    27.186771874999998,
    27.58657734375,
    27.77472109375,
    27.8923109375,
    27.58657734375,
    27.7982390625,
    28.00990078125,
    27.91582890625,
    27.82175703125,
    28.24508046875,
    28.48026015625,
    28.52729609375,
    28.127490625,
    27.9863828125,
    27.7041671875,
    27.751203125,
    27.7982390625,
    27.63361328125,
    27.65713125,
    28.05693671875,
    28.0804546875,
    27.8923109375,
    28.10397265625,
    27.9863828125,
    27.58657734375,
    27.7041671875,
    28.15100859375,
    28.29211640625,
    27.91582890625,
    27.7041671875,
    28.05693671875,
    27.91582890625,
    28.0804546875,
    27.72768515625,
    27.5160234375,
    27.68064921875,
    27.845275,
    27.751203125,
    28.2215625,
    28.4567421875,
    28.691921875,
    28.43322421875,
    28.00990078125,
    27.53954140625,
    27.6100953125,
    27.4689875,
    27.0456640625,
    27.39843359375,
    27.49250546875,
    27.8923109375,
    27.86879296875,
    27.82175703125,
    27.7041671875,
    28.29211640625,
    28.4567421875,
    28.315634375,
    28.315634375,
    28.503778125,
    28.62136796875,
    28.43322421875,
    28.33915234375,
    28.0804546875,
    27.7982390625,
    27.49250546875,
    28.05693671875,
    28.15100859375,
    28.10397265625,
    28.4567421875,
    28.40970625,
    28.80951171875,
    28.38618828125,
    28.315634375,
    27.96286484375,
    27.7982390625,
    27.86879296875,
    27.9863828125,
    27.86879296875,
    26.90455625,
    26.293089062499998,
    25.0701546875,
    24.5997953125,
    24.15295390625,
    22.83594765625,
    21.28376171875,
    19.5199140625,
    17.87365625,
    15.898146875,
    12.887846875,
    10.23031640625,
    6.5379953125,
    2.75160234375,
    -0.39980546875,
    -3.83342890625,
    -5.57375859375,
    -6.302815625,
    -6.7261390625,
    -6.37336953125,
    -6.4439234375,
    -5.5972765625,
    -6.0206,
    -6.114671875,
    -6.04411796875,
    -6.56151328125,
    -6.74965703125,
    -6.60854921875,
    -6.867246875,
    -6.09115390625,
    -5.926528125,
    -5.38561484375,
    -5.5032046875,
    -5.95004609375,
    -6.65558515625,
    -6.96131875
  ]

  @max_points [
    -6.98483671875,
    -6.9142828125,
    -7.07890859375,
    -7.0083546875,
    -6.65558515625,
    -6.42040546875,
    -6.46744140625,
    -6.46744140625,
    -6.3498515625,
    -6.27929765625,
    -6.490959375,
    -6.3968875,
    -6.490959375,
    -6.302815625,
    -6.3968875,
    -6.3498515625,
    -6.679103125,
    -6.58503125,
    -6.42040546875,
    -6.27929765625,
    -5.9735640625,
    -5.8794921875,
    -5.76190234375,
    -6.09115390625,
    -6.56151328125,
    -6.56151328125,
    -6.679103125,
    -6.32633359375,
    -6.23226171875,
    -6.09115390625,
    -6.58503125,
    -6.2557796875,
    -5.5972765625,
    -5.29154296875,
    -5.3150609375,
    -5.4091328125,
    -5.268025,
    -4.86821953125,
    -4.9387734375,
    -5.0328453125,
    -5.0328453125,
    -5.1269171875,
    -4.86821953125,
    -4.35082421875,
    -4.20971640625,
    -4.5154499999999995,
    -4.53896796875,
    -4.58600390625,
    -4.49193203125,
    -4.8447015625,
    -4.72711171875,
    -4.82118359375,
    -4.8447015625,
    -4.797665625,
    -4.3743421875,
    -4.06860859375,
    -4.32730625,
    -4.7506296875,
    -4.9387734375,
    -4.91525546875,
    -5.3385789062499995,
    -5.0328453125,
    -4.9387734375,
    -4.5624859375,
    -4.8917375,
    -5.268025,
    -5.38561484375,
    -5.268025,
    -5.362096875,
    -4.8917375,
    -4.72711171875,
    -4.58600390625,
    -4.5154499999999995,
    -4.985809375,
    -4.7506296875,
    -5.0328453125,
    -5.173953125,
    -5.05636328125,
    -4.5154499999999995,
    -4.5154499999999995,
    -4.70359375,
    -5.05636328125,
    -5.15043515625,
    -5.0328453125,
    -4.9387734375,
    -5.05636328125,
    -5.10339921875,
    -5.00932734375,
    -5.05636328125,
    -5.1269171875,
    -4.9387734375,
    -4.86821953125,
    -5.05636328125,
    -4.8447015625,
    -4.96229140625,
    -5.29154296875,
    -5.738384375,
    -5.85597421875,
    -5.6913484375,
    -5.2209890625,
    -5.1269171875,
    -5.362096875,
    -5.29154296875,
    -5.0328453125,
    -5.173953125,
    -5.10339921875,
    -5.3150609375,
    -5.738384375,
    -6.23226171875,
    -5.43265078125,
    -5.3150609375,
    -5.47968671875,
    -6.1617078124999995,
    -5.85597421875,
    -5.76190234375,
    -6.27929765625,
    -5.66783046875,
    -5.62079453125,
    -5.5032046875,
    -5.8794921875,
    -6.0676359374999995,
    -6.3968875,
    -6.3968875,
    -6.0206,
    -5.7854203125,
    -5.38561484375,
    -5.3385789062499995,
    -5.0328453125,
    -4.70359375,
    -5.00932734375,
    -5.29154296875,
    -5.43265078125,
    -5.07988125,
    -5.0328453125,
    -4.985809375,
    -5.76190234375,
    -5.83245625,
    -5.6913484375,
    -5.83245625,
    -5.71486640625,
    -5.45616875,
    -5.268025,
    -5.95004609375,
    -5.83245625,
    -5.90301015625,
    -5.4091328125,
    -5.3385789062499995,
    -5.6913484375,
    -5.5032046875,
    -5.76190234375,
    -5.80893828125,
    -6.0206,
    -6.58503125,
    -6.51447734375,
    -6.302815625,
    -6.09115390625,
    -5.99708203125,
    -6.3968875,
    -6.09115390625,
    -6.0676359374999995,
    -5.95004609375,
    -5.5972765625,
    -5.52672265625,
    -5.43265078125,
    -5.71486640625,
    -5.76190234375,
    -6.0676359374999995,
    -5.926528125,
    -5.8794921875,
    -5.5972765625,
    -5.3150609375,
    -5.4091328125,
    -5.43265078125,
    -5.3150609375,
    -5.6443125,
    -5.95004609375,
    -6.13818984375,
    -6.04411796875,
    -6.1617078124999995,
    -5.62079453125,
    -5.57375859375,
    -5.5972765625,
    -5.173953125,
    -5.15043515625,
    -5.8794921875,
    -6.13818984375,
    -6.2557796875,
    -6.114671875,
    -5.90301015625,
    -6.09115390625,
    -5.85597421875,
    -5.738384375,
    -5.90301015625,
    -5.5972765625,
    -5.5972765625,
    -5.8794921875,
    -6.27929765625,
    -5.85597421875,
    -5.926528125,
    -6.3968875,
    -6.65558515625,
    -6.27929765625,
    -5.95004609375,
    -5.6913484375,
    -5.52672265625,
    -5.57375859375,
    -5.80893828125,
    -5.8794921875,
    -5.71486640625,
    -5.52672265625,
    -5.52672265625,
    -5.8794921875,
    -6.0206,
    -5.7854203125,
    -6.2557796875,
    -6.23226171875,
    -6.09115390625,
    -6.09115390625,
    -6.3968875,
    -6.18522578125,
    -6.74965703125,
    -6.4439234375,
    -6.74965703125,
    -6.7261390625,
    -6.74965703125,
    -6.773175,
    -6.7261390625,
    -6.6320671875,
    -6.51447734375,
    -6.18522578125,
    -6.114671875,
    -6.09115390625,
    -6.20874375,
    -6.42040546875,
    -6.04411796875,
    -5.8794921875,
    -6.18522578125,
    -6.2557796875,
    -6.04411796875,
    -6.37336953125,
    -6.60854921875,
    -6.3968875,
    -6.23226171875,
    -5.8794921875,
    -6.13818984375,
    -6.0206,
    -6.13818984375,
    -6.490959375,
    -6.8907648437499995,
    -7.0083546875,
    -7.1964984375,
    -6.84372890625,
    -6.93780078125,
    -6.5379953125,
    -5.71486640625,
    -5.71486640625,
    -6.302815625,
    -6.490959375,
    -6.679103125,
    -6.490959375,
    -6.3498515625,
    -6.490959375,
    -6.98483671875,
    -7.055390625,
    -6.4439234375,
    -6.5379953125,
    -6.679103125,
    -6.84372890625,
    -6.74965703125,
    -6.27929765625,
    -6.18522578125,
    -6.58503125,
    -6.3498515625,
    -6.13818984375,
    -5.99708203125,
    -6.04411796875,
    -6.46744140625,
    -6.3968875,
    -6.32633359375,
    -6.4439234375,
    -6.773175,
    -7.22001640625,
    -7.03187265625,
    -7.1494625,
    -7.1964984375,
    -7.0083546875,
    -6.5379953125,
    -6.46744140625,
    -6.23226171875,
    -6.302815625,
    -6.42040546875,
    -6.13818984375,
    -6.46744140625,
    -6.58503125,
    -6.8907648437499995,
    -6.96131875,
    -6.74965703125,
    -6.74965703125,
    -6.70262109375,
    -7.03187265625,
    -7.0083546875,
    -6.60854921875,
    -6.7261390625,
    -6.60854921875,
    -6.65558515625,
    -6.20874375,
    -6.1617078124999995,
    -6.1617078124999995,
    -6.32633359375,
    -6.51447734375,
    -6.7966929687499995,
    -6.46744140625,
    -6.58503125,
    -6.46744140625,
    -6.42040546875,
    -6.490959375,
    -6.679103125,
    -6.74965703125,
    -6.9142828125,
    -6.27929765625,
    -6.58503125,
    -6.773175,
    -6.7966929687499995,
    -6.65558515625,
    -6.32633359375,
    -6.27929765625,
    -6.23226171875,
    -6.3498515625,
    -6.6320671875,
    -6.70262109375,
    -6.51447734375,
    -6.3968875,
    -6.7966929687499995,
    -6.51447734375,
    -6.2557796875,
    -6.56151328125,
    -6.0676359374999995,
    -6.27929765625,
    -6.18522578125,
    -6.27929765625,
    -6.56151328125,
    -6.56151328125,
    -6.679103125,
    -6.42040546875,
    -6.70262109375,
    -6.2557796875,
    -6.20874375,
    -6.20874375,
    -6.18522578125,
    -6.0676359374999995,
    -6.60854921875,
    -6.679103125,
    -6.58503125,
    -6.46744140625,
    -6.27929765625,
    -6.679103125,
    -6.8907648437499995,
    -6.46744140625,
    -6.5379953125,
    -6.20874375,
    -6.18522578125,
    -6.302815625,
    -6.8907648437499995,
    -6.867246875,
    -6.8202109375,
    -6.6320671875,
    -6.3968875,
    -5.85597421875,
    -6.114671875,
    -6.20874375,
    -6.46744140625,
    -6.8907648437499995,
    -6.4439234375,
    -6.58503125,
    -6.3498515625,
    -6.27929765625,
    -6.490959375,
    -6.70262109375,
    -6.490959375,
    -6.3498515625,
    -6.773175,
    -6.8907648437499995,
    -6.96131875,
    -6.8907648437499995,
    -6.867246875,
    -6.60854921875,
    -6.490959375,
    -6.2557796875,
    -6.42040546875,
    -6.74965703125,
    -6.3498515625,
    -6.09115390625,
    -6.13818984375,
    -6.32633359375,
    -6.27929765625,
    -6.51447734375,
    -6.679103125,
    -6.6320671875,
    -7.07890859375,
    -7.1494625,
    -6.6320671875,
    -6.96131875,
    -6.70262109375,
    -6.490959375,
    -6.13818984375,
    -6.51447734375,
    -6.42040546875,
    -6.32633359375,
    -6.09115390625,
    -6.0676359374999995,
    -6.302815625,
    -6.7261390625,
    -6.84372890625,
    -7.03187265625,
    -7.0083546875,
    -6.7261390625,
    -6.3968875,
    -6.3498515625,
    -6.18522578125,
    -6.65558515625,
    -6.56151328125,
    -6.65558515625,
    -6.56151328125,
    -6.6320671875,
    -6.773175,
    -6.93780078125,
    -6.96131875,
    -6.56151328125,
    -6.2557796875,
    -6.46744140625,
    -6.23226171875,
    -5.76190234375,
    -6.13818984375,
    -6.27929765625,
    -6.42040546875,
    -6.65558515625,
    -6.74965703125,
    -6.32633359375,
    -6.0206,
    -6.09115390625,
    -6.3498515625,
    -6.60854921875,
    -7.055390625,
    -6.60854921875,
    -6.2557796875,
    -5.99708203125,
    -6.114671875,
    -6.2557796875,
    -6.679103125,
    -5.99708203125,
    -6.20874375,
    -6.23226171875,
    -6.13818984375,
    -5.95004609375,
    -5.9735640625,
    -5.95004609375,
    -6.18522578125,
    -5.52672265625,
    -4.20971640625,
    -1.57570390625,
    2.6340125,
    6.70262109375,
    9.47774140625,
    12.7467390625,
    15.6629671875,
    18.908446875,
    21.1191359375,
    22.7183578125,
    24.0353640625,
    25.77569375,
    26.83400234375,
    27.7982390625,
    28.38618828125,
    29.27987109375,
    30.0559640625,
    30.22058984375,
    30.29114375,
    30.26762578125,
    30.22058984375,
    30.5263234375,
    30.855574999999998,
    30.9966828125,
    31.2788984375,
    31.0907546875,
    31.06723671875,
    30.97316484375,
    30.855574999999998,
    30.92612890625,
    31.1848265625,
    31.325934375,
    31.58463203125,
    31.702221875,
    31.67870390625,
    31.3729703125,
    31.5611140625,
    31.490560156249998,
    31.44352421875,
    31.490560156249998,
    31.20834453125,
    31.06723671875,
    30.92612890625,
    30.83205703125,
    31.0907546875,
    30.855574999999998,
    30.855574999999998,
    30.92612890625,
    30.45576953125,
    30.40873359375,
    30.59687734375,
    30.7144671875,
    31.04371875,
    31.325934375,
    31.77277578125,
    31.2788984375,
    30.9966828125,
    31.53759609375,
    31.6551859375,
    31.39648828125,
    31.1848265625,
    30.69094921875,
    30.66743125,
    30.83205703125,
    30.9026109375,
    31.114272656249998,
    31.114272656249998,
    31.04371875,
    31.06723671875,
    30.949646875,
    31.114272656249998,
    31.20834453125,
    31.02020078125,
    30.40873359375,
    30.69094921875,
    30.9026109375,
    30.6203953125,
    30.9026109375,
    30.97316484375,
    30.855574999999998,
    30.573359375,
    30.573359375,
    31.20834453125,
    31.53759609375,
    31.16130859375,
    30.83205703125,
    30.855574999999998,
    30.479287499999998,
    30.40873359375,
    30.45576953125,
    30.50280546875,
    30.59687734375,
    29.6796765625,
    28.95061953125,
    28.5508140625,
    27.53954140625,
    26.622340625,
    25.37588828125,
    24.4116515625,
    22.76539375,
    20.76636640625,
    18.50864140625,
    15.68648515625,
    12.5585953125,
    9.313115625,
    6.56151328125,
    2.70456640625,
    -0.9877546875,
    -3.92750078125,
    -5.24450703125,
    -5.738384375,
    -5.99708203125,
    -6.0206,
    -6.0676359374999995,
    -6.46744140625,
    -6.65558515625,
    -6.60854921875,
    -6.51447734375,
    -6.32633359375,
    -6.09115390625,
    -6.1617078124999995,
    -5.6913484375,
    -5.76190234375,
    -5.7854203125,
    -6.04411796875,
    -6.2557796875,
    -6.490959375,
    -6.58503125,
    -6.42040546875,
    -6.04411796875,
    -6.302815625,
    -6.42040546875,
    -6.32633359375,
    -6.3498515625,
    -6.58503125,
    -7.17298046875,
    -7.1024265625,
    -6.679103125,
    -6.46744140625,
    -6.302815625,
    -6.09115390625,
    -6.37336953125,
    -6.46744140625,
    -6.490959375,
    -6.4439234375,
    -6.4439234375,
    -6.20874375,
    -5.85597421875,
    -6.0676359374999995,
    -6.302815625,
    -6.18522578125,
    -6.20874375,
    -5.95004609375,
    -5.83245625,
    -5.3385789062499995,
    -5.71486640625,
    -5.80893828125,
    -6.0676359374999995,
    -6.2557796875,
    -6.60854921875,
    -7.07890859375,
    -6.37336953125,
    -6.42040546875,
    -6.6320671875,
    -6.56151328125,
    -6.51447734375,
    -6.58503125,
    -6.6320671875,
    -6.37336953125,
    -6.58503125,
    -6.32633359375,
    -6.302815625,
    -6.490959375,
    -6.46744140625,
    -6.70262109375,
    -6.37336953125,
    -6.3968875,
    -6.773175,
    -6.74965703125,
    -6.20874375,
    -6.23226171875,
    -6.302815625,
    -6.70262109375,
    -6.7261390625,
    -6.70262109375,
    -6.3498515625,
    -6.58503125,
    -6.70262109375,
    -6.7261390625,
    -6.58503125,
    -6.1617078124999995,
    -6.09115390625,
    -6.114671875,
    -5.80893828125,
    -5.99708203125,
    -6.0206,
    -6.32633359375,
    -6.74965703125,
    -6.9142828125,
    -6.58503125,
    -6.3968875,
    -6.2557796875,
    -6.20874375,
    -6.60854921875,
    -6.867246875,
    -6.65558515625,
    -6.74965703125,
    -6.46744140625,
    -6.37336953125,
    -5.95004609375,
    -6.18522578125,
    -6.3968875,
    -6.5379953125,
    -6.490959375,
    -6.04411796875,
    -6.20874375,
    -5.173953125,
    -2.4929046875,
    1.222934375,
    5.268025,
    8.34887890625,
    11.6178765625,
    14.581140625,
    16.95645546875,
    19.12010859375,
    21.00154609375,
    22.27151640625,
    23.3768609375,
    24.57627734375,
    25.5405140625,
    26.4812328125,
    27.11621796875,
    27.30436171875,
    27.16325390625,
    27.5160234375,
    27.8923109375,
    27.7982390625,
    27.44546953125,
    27.44546953125,
    27.7982390625,
    27.65713125,
    27.49250546875,
    27.4689875,
    27.68064921875,
    27.751203125,
    27.58657734375,
    27.63361328125,
    27.58657734375,
    27.4689875,
    27.58657734375,
    28.00990078125,
    28.127490625,
    27.7041671875,
    27.7041671875,
    28.2215625,
    27.91582890625,
    27.8923109375,
    27.96286484375,
    27.91582890625,
    27.8923109375,
    27.751203125,
    27.7982390625,
    27.68064921875,
    27.845275,
    27.58657734375,
    27.563059374999998,
    28.00990078125,
    27.96286484375,
    27.53954140625,
    27.8923109375,
    27.82175703125,
    28.29211640625,
    28.503778125,
    28.43322421875,
    27.563059374999998,
    27.44546953125,
    27.86879296875,
    27.86879296875,
    27.72768515625,
    27.63361328125,
    28.00990078125,
    27.751203125,
    28.15100859375,
    27.7982390625,
    27.39843359375,
    27.58657734375,
    27.96286484375,
    28.15100859375,
    27.91582890625,
    27.4689875,
    27.563059374999998,
    27.21028984375,
    27.7041671875,
    27.751203125,
    27.77472109375,
    27.58657734375,
    27.72768515625,
    27.53954140625,
    27.7982390625,
    28.24508046875,
    28.0804546875,
    28.24508046875,
    28.48026015625,
    28.3626703125,
    28.127490625,
    28.2685984375,
    28.10397265625,
    28.1745265625,
    28.33915234375,
    28.03341875,
    28.2685984375,
    28.62136796875,
    28.78599375,
    28.127490625,
    28.127490625,
    28.43322421875,
    28.3626703125,
    28.24508046875,
    27.6100953125,
    27.8923109375,
    28.315634375,
    28.2215625,
    28.0804546875,
    28.24508046875,
    28.33915234375,
    28.2685984375,
    28.33915234375,
    28.40970625,
    28.15100859375,
    27.63361328125,
    27.63361328125,
    27.58657734375,
    27.58657734375,
    28.29211640625,
    28.198044531249998,
    28.0804546875,
    28.3626703125,
    28.05693671875,
    27.96286484375,
    27.39843359375,
    27.8923109375,
    28.00990078125,
    27.86879296875,
    28.05693671875,
    27.86879296875,
    27.91582890625,
    28.00990078125,
    28.127490625,
    28.43322421875,
    28.52729609375,
    28.2215625,
    27.77472109375,
    27.63361328125,
    27.563059374999998,
    27.8923109375,
    28.2685984375,
    27.8923109375,
    27.65713125,
    27.7041671875,
    28.0804546875,
    28.503778125,
    28.4567421875,
    28.3626703125,
    28.43322421875,
    28.43322421875,
    28.0804546875,
    28.0804546875,
    27.82175703125,
    27.58657734375,
    27.4689875,
    27.63361328125,
    27.845275,
    28.0804546875,
    27.845275,
    28.0804546875,
    28.33915234375,
    28.198044531249998,
    28.198044531249998,
    28.62136796875,
    28.29211640625,
    28.00990078125,
    27.8923109375,
    27.845275,
    28.574332031249998,
    28.9741375,
    29.16228125,
    29.0211734375,
    28.691921875,
    28.03341875,
    28.00990078125,
    28.15100859375,
    27.77472109375,
    27.939346875,
    27.8923109375,
    28.198044531249998,
    28.2215625,
    28.15100859375,
    27.44546953125,
    27.5160234375,
    27.96286484375,
    28.05693671875,
    28.33915234375,
    28.80951171875,
    29.068209375,
    28.85654765625,
    28.33915234375,
    28.00990078125,
    27.9863828125,
    28.198044531249998,
    28.574332031249998,
    28.7389578125,
    28.90358359375,
    28.99765546875,
    28.833029687499998,
    28.691921875,
    28.691921875,
    28.574332031249998,
    27.8923109375,
    28.198044531249998,
    28.3626703125,
    28.3626703125,
    28.2215625,
    28.15100859375,
    28.0804546875,
    28.00990078125,
    28.05693671875,
    27.9863828125,
    27.91582890625,
    27.86879296875,
    28.0804546875,
    28.40970625,
    28.3626703125,
    28.29211640625,
    28.24508046875,
    28.05693671875,
    27.86879296875,
    27.751203125,
    28.29211640625,
    28.6448859375,
    28.43322421875,
    28.503778125,
    28.38618828125,
    28.2215625,
    28.29211640625,
    27.9863828125,
    27.9863828125,
    27.96286484375,
    28.0804546875,
    27.86879296875,
    27.86879296875,
    28.10397265625,
    28.66840390625,
    28.7389578125,
    28.48026015625,
    28.198044531249998,
    27.939346875,
    28.52729609375,
    28.3626703125,
    28.2215625,
    28.127490625,
    28.2685984375,
    28.76247578125,
    28.71543984375,
    28.33915234375,
    28.3626703125,
    28.48026015625,
    28.52729609375,
    28.127490625,
    27.9863828125,
    28.15100859375,
    28.2685984375,
    27.82175703125,
    27.63361328125,
    27.751203125,
    28.05693671875,
    28.15100859375,
    27.96286484375,
    28.40970625,
    28.503778125,
    28.48026015625,
    28.59785,
    28.78599375,
    28.52729609375,
    28.33915234375,
    28.315634375,
    28.833029687499998,
    28.71543984375,
    28.1745265625,
    28.2215625,
    28.198044531249998,
    28.4567421875,
    27.9863828125,
    28.2215625,
    28.80951171875,
    28.6448859375,
    28.691921875,
    28.5508140625,
    28.03341875,
    28.2685984375,
    28.38618828125,
    28.2215625,
    28.05693671875,
    28.24508046875,
    28.24508046875,
    28.4567421875,
    28.315634375,
    28.59785,
    28.833029687499998,
    28.691921875,
    28.880065625,
    28.315634375,
    28.574332031249998,
    28.76247578125,
    28.85654765625,
    28.78599375,
    29.09172734375,
    28.95061953125,
    28.315634375,
    28.33915234375,
    28.503778125,
    28.43322421875,
    28.15100859375,
    28.4567421875,
    28.66840390625,
    29.09172734375,
    28.80951171875,
    28.52729609375,
    29.0211734375,
    28.62136796875,
    28.2215625,
    28.03341875,
    27.86879296875,
    27.77472109375,
    27.2338078125,
    26.434196875,
    25.5405140625,
    24.57627734375,
    23.49445078125,
    22.22448046875,
    20.57822265625,
    18.5791953125,
    15.898146875,
    13.33468828125,
    10.60660390625,
    7.1964984375,
    2.75160234375,
    -0.39980546875,
    -3.83342890625,
    -5.57375859375,
    -6.302815625,
    -6.7261390625,
    -6.37336953125,
    -6.4439234375,
    -5.5972765625,
    -6.0206,
    -6.114671875,
    -6.04411796875,
    -6.56151328125,
    -6.74965703125,
    -6.60854921875,
    -6.867246875,
    -6.09115390625,
    -5.926528125,
    -5.38561484375,
    -5.5032046875,
    -5.95004609375,
    -6.65558515625,
    -6.96131875
  ]

  @min_points [
    -18.50864140625,
    -18.061799999999998,
    -18.344015625,
    -18.17938984375,
    -18.55567734375,
    -18.155871875,
    -18.720303125,
    -18.2969796875,
    -18.41456953125,
    -17.85013828125,
    -18.2029078125,
    -18.17938984375,
    -18.60271328125,
    -18.344015625,
    -18.60271328125,
    -17.9206921875,
    -18.5791953125,
    -18.0147640625,
    -18.3910515625,
    -17.8266203125,
    -18.5791953125,
    -17.99124609375,
    -18.2969796875,
    -17.80310234375,
    -18.6732671875,
    -18.344015625,
    -18.62623125,
    -17.779584375,
    -18.36753359375,
    -18.03828203125,
    -18.27346171875,
    -17.99124609375,
    -18.69678515625,
    -18.1088359375,
    -18.27346171875,
    -17.7325484375,
    -18.36753359375,
    -17.85013828125,
    -18.2969796875,
    -17.66199453125,
    -18.41456953125,
    -17.9206921875,
    -18.27346171875,
    -17.99124609375,
    -18.55567734375,
    -17.99124609375,
    -18.17938984375,
    -17.99124609375,
    -18.60271328125,
    -18.27346171875,
    -18.532159375,
    -18.061799999999998,
    -18.74382109375,
    -18.08531796875,
    -18.36753359375,
    -17.8266203125,
    -18.50864140625,
    -17.8266203125,
    -18.24994375,
    -17.426814843749998,
    -18.32049765625,
    -17.5444046875,
    -18.438087499999998,
    -17.47385078125,
    -18.344015625,
    -17.94421015625,
    -18.22642578125,
    -17.6855125,
    -18.344015625,
    -17.87365625,
    -18.2969796875,
    -17.6855125,
    -18.24994375,
    -17.94421015625,
    -18.22642578125,
    -17.70903046875,
    -18.41456953125,
    -18.2029078125,
    -18.7673390625,
    -18.2029078125,
    -18.64974921875,
    -17.967728125,
    -18.27346171875,
    -17.967728125,
    -18.55567734375,
    -18.03828203125,
    -18.438087499999998,
    -17.99124609375,
    -18.438087499999998,
    -17.779584375,
    -18.2029078125,
    -17.61495859375,
    -18.2029078125,
    -17.7325484375,
    -18.2029078125,
    -17.7325484375,
    -18.22642578125,
    -17.7325484375,
    -18.155871875,
    -17.75606640625,
    -18.24994375,
    -17.4503328125,
    -17.6384765625,
    -17.3562609375,
    -17.52088671875,
    -17.37977890625,
    -17.4503328125,
    -17.28570703125,
    -18.155871875,
    -18.17938984375,
    -18.344015625,
    -17.4503328125,
    -18.46160546875,
    -18.155871875,
    -18.2029078125,
    -17.6384765625,
    -18.1088359375,
    -18.03828203125,
    -18.438087499999998,
    -17.89717421875,
    -18.64974921875,
    -18.061799999999998,
    -18.2029078125,
    -17.75606640625,
    -18.46160546875,
    -17.967728125,
    -18.2969796875,
    -17.6855125,
    -18.3910515625,
    -18.0147640625,
    -18.344015625,
    -17.8266203125,
    -18.41456953125,
    -18.17938984375,
    -18.720303125,
    -18.061799999999998,
    -18.60271328125,
    -18.061799999999998,
    -18.24994375,
    -18.08531796875,
    -18.55567734375,
    -18.0147640625,
    -18.08531796875,
    -17.37977890625,
    -18.24994375,
    -17.85013828125,
    -18.22642578125,
    -17.99124609375,
    -18.4851234375,
    -18.155871875,
    -18.32049765625,
    -17.6384765625,
    -18.2029078125,
    -17.5444046875,
    -18.13235390625,
    -17.49736875,
    -18.08531796875,
    -17.87365625,
    -18.27346171875,
    -17.80310234375,
    -18.3910515625,
    -18.27346171875,
    -18.32049765625,
    -17.61495859375,
    -18.08531796875,
    -17.94421015625,
    -18.13235390625,
    -17.80310234375,
    -18.55567734375,
    -18.03828203125,
    -18.438087499999998,
    -18.0147640625,
    -18.46160546875,
    -17.9206921875,
    -17.89717421875,
    -17.85013828125,
    -18.155871875,
    -17.75606640625,
    -18.2029078125,
    -17.75606640625,
    -18.2969796875,
    -17.75606640625,
    -18.08531796875,
    -17.49736875,
    -18.438087499999998,
    -17.967728125,
    -18.46160546875,
    -18.08531796875,
    -18.50864140625,
    -18.2029078125,
    -18.532159375,
    -17.89717421875,
    -18.55567734375,
    -17.967728125,
    -18.50864140625,
    -17.66199453125,
    -18.1088359375,
    -17.75606640625,
    -18.24994375,
    -17.47385078125,
    -18.3910515625,
    -17.9206921875,
    -18.08531796875,
    -17.6384765625,
    -18.2969796875,
    -17.75606640625,
    -18.17938984375,
    -17.61495859375,
    -18.061799999999998,
    -17.75606640625,
    -18.17938984375,
    -17.5444046875,
    -18.344015625,
    -17.967728125,
    -18.438087499999998,
    -17.591440625,
    -18.24994375,
    -17.8266203125,
    -18.24994375,
    -17.6855125,
    -18.2029078125,
    -17.779584375,
    -18.2029078125,
    -17.6855125,
    -18.46160546875,
    -18.03828203125,
    -18.532159375,
    -18.0147640625,
    -18.55567734375,
    -17.967728125,
    -18.22642578125,
    -17.56792265625,
    -18.344015625,
    -18.155871875,
    -18.532159375,
    -17.9206921875,
    -18.4851234375,
    -18.0147640625,
    -18.438087499999998,
    -18.061799999999998,
    -18.6732671875,
    -18.061799999999998,
    -18.3910515625,
    -17.70903046875,
    -18.50864140625,
    -17.9206921875,
    -18.2969796875,
    -17.591440625,
    -18.50864140625,
    -17.9206921875,
    -18.155871875,
    -18.0147640625,
    -18.46160546875,
    -18.2969796875,
    -18.60271328125,
    -17.87365625,
    -18.720303125,
    -18.36753359375,
    -18.155871875,
    -17.89717421875,
    -18.155871875,
    -17.4503328125,
    -17.967728125,
    -17.6855125,
    -18.46160546875,
    -17.8266203125,
    -17.87365625,
    -17.6384765625,
    -18.32049765625,
    -17.85013828125,
    -18.36753359375,
    -17.4503328125,
    -18.55567734375,
    -18.2029078125,
    -18.5791953125,
    -18.1088359375,
    -18.36753359375,
    -17.87365625,
    -18.438087499999998,
    -17.85013828125,
    -18.438087499999998,
    -18.13235390625,
    -18.13235390625,
    -17.87365625,
    -18.32049765625,
    -18.061799999999998,
    -18.438087499999998,
    -17.7325484375,
    -18.69678515625,
    -17.967728125,
    -18.17938984375,
    -17.591440625,
    -17.967728125,
    -17.87365625,
    -18.32049765625,
    -17.85013828125,
    -18.36753359375,
    -17.94421015625,
    -18.2029078125,
    -17.89717421875,
    -18.32049765625,
    -17.779584375,
    -18.2029078125,
    -17.89717421875,
    -18.64974921875,
    -18.0147640625,
    -18.0147640625,
    -17.00349140625,
    -17.426814843749998,
    -17.1681171875,
    -17.967728125,
    -17.61495859375,
    -18.22642578125,
    -17.70903046875,
    -18.22642578125,
    -17.4503328125,
    -18.344015625,
    -17.8266203125,
    -17.87365625,
    -17.591440625,
    -18.32049765625,
    -17.591440625,
    -18.24994375,
    -17.80310234375,
    -18.344015625,
    -17.47385078125,
    -18.24994375,
    -17.8266203125,
    -18.36753359375,
    -18.155871875,
    -18.24994375,
    -17.70903046875,
    -18.03828203125,
    -17.4503328125,
    -18.13235390625,
    -17.7325484375,
    -18.2029078125,
    -17.87365625,
    -18.2029078125,
    -17.85013828125,
    -18.061799999999998,
    -17.75606640625,
    -17.967728125,
    -17.56792265625,
    -18.344015625,
    -17.85013828125,
    -18.1088359375,
    -17.8266203125,
    -18.438087499999998,
    -17.99124609375,
    -18.438087499999998,
    -17.85013828125,
    -18.27346171875,
    -17.779584375,
    -17.99124609375,
    -17.2621890625,
    -17.47385078125,
    -16.72127578125,
    -17.7325484375,
    -17.4503328125,
    -17.99124609375,
    -17.37977890625,
    -18.24994375,
    -17.85013828125,
    -18.438087499999998,
    -17.85013828125,
    -18.36753359375,
    -17.61495859375,
    -17.967728125,
    -17.37977890625,
    -17.89717421875,
    -17.61495859375,
    -18.13235390625,
    -17.8266203125,
    -18.0147640625,
    -17.33274296875,
    -18.36753359375,
    -18.061799999999998,
    -18.08531796875,
    -17.61495859375,
    -18.08531796875,
    -17.9206921875,
    -18.36753359375,
    -17.967728125,
    -18.344015625,
    -17.49736875,
    -17.52088671875,
    -17.309225,
    -17.5444046875,
    -17.52088671875,
    -18.155871875,
    -17.61495859375,
    -18.24994375,
    -17.8266203125,
    -18.17938984375,
    -17.85013828125,
    -18.22642578125,
    -17.87365625,
    -18.27346171875,
    -17.87365625,
    -18.4851234375,
    -17.99124609375,
    -17.70903046875,
    -15.9451828125,
    -17.215153125,
    -17.5444046875,
    -17.37977890625,
    -17.591440625,
    -17.85013828125,
    -17.37977890625,
    -17.49736875,
    -16.8859015625,
    -17.80310234375,
    -17.215153125,
    -18.24994375,
    -17.28570703125,
    -18.17938984375,
    -16.6977578125,
    -17.7325484375,
    -17.28570703125,
    -16.90941953125,
    -17.00349140625,
    -18.17938984375,
    -17.8266203125,
    -18.60271328125,
    -18.13235390625,
    -17.967728125,
    -17.426814843749998,
    -18.0147640625,
    -17.56792265625,
    -18.0147640625,
    -18.0147640625,
    -18.27346171875,
    -17.85013828125,
    -17.1681171875,
    -16.55665,
    -17.33274296875,
    -15.73352109375,
    -18.08531796875,
    -16.3214703125,
    -18.32049765625,
    -17.61495859375,
    -17.87365625,
    -17.5444046875,
    -18.24994375,
    -16.58016796875,
    -18.1088359375,
    -17.66199453125,
    -18.08531796875,
    -16.81534765625,
    -17.80310234375,
    -17.403296875,
    -18.061799999999998,
    -17.00349140625,
    -16.9799734375,
    -15.8511109375,
    -17.0740453125,
    -16.62720390625,
    -16.4155421875,
    -13.71097578125,
    -17.426814843749998,
    -16.20388046875,
    -17.09756328125,
    -14.392996875,
    -17.5444046875,
    -17.37977890625,
    -17.85013828125,
    -16.1803625,
    -17.309225,
    -16.156844531249998,
    -17.85013828125,
    -16.838865625,
    -18.27346171875,
    -17.591440625,
    -17.70903046875,
    -15.874628906249999,
    -17.66199453125,
    -16.34498828125,
    -17.89717421875,
    -15.898146875,
    -17.00349140625,
    -12.86432890625,
    -15.59241328125,
    -14.11078125,
    -13.54635,
    -14.86335625,
    -17.66199453125,
    -12.6526671875,
    -11.9941640625,
    -15.521859375,
    -14.65169453125,
    -14.6752125,
    -15.239643749999999,
    -10.8653015625,
    -13.8756015625,
    -12.20582578125,
    -11.312142968749999,
    -9.14848984375,
    -10.51253203125,
    -9.5482953125,
    -15.4748234375,
    -11.54732265625,
    -13.28765234375,
    -12.135271874999999,
    -11.35917890625,
    -9.7364390625,
    -13.33468828125,
    -12.72322109375,
    -11.59435859375,
    -9.33663359375,
    -9.57181328125,
    -9.28959765625,
    -8.8897921875,
    -8.91331015625,
    -9.24256171875,
    -8.91331015625,
    -9.33663359375,
    -9.66588515625,
    -14.83983828125,
    -13.42876015625,
    -14.298925,
    -14.79280234375,
    -13.264134375,
    -12.699703125,
    -14.83983828125,
    -12.34693359375,
    -10.9123375,
    -12.5585953125,
    -9.75995703125,
    -11.78250234375,
    -12.06471796875,
    -11.64139453125,
    -15.78055703125,
    -12.323415624999999,
    -16.76831171875,
    -11.02992734375,
    -13.4052421875,
    -11.947128125,
    -15.61593125,
    -13.09950859375,
    -17.85013828125,
    -12.4645234375,
    -16.95645546875,
    -14.36947890625,
    -15.239643749999999,
    -12.81729296875,
    -16.29795234375,
    -15.99221875,
    -14.957428125,
    -15.239643749999999,
    -18.155871875,
    -16.838865625,
    -18.27346171875,
    -15.874628906249999,
    -18.13235390625,
    -15.92166484375,
    -17.52088671875,
    -14.93391015625,
    -15.61593125,
    -16.1333265625,
    -17.215153125,
    -14.86335625,
    -16.462578125,
    -16.791829687499998,
    -17.85013828125,
    -16.8859015625,
    -16.95645546875,
    -15.61593125,
    -17.6855125,
    -17.4503328125,
    -17.967728125,
    -16.95645546875,
    -17.12108125,
    -15.333715625,
    -18.27346171875,
    -16.62720390625,
    -17.9206921875,
    -17.4503328125,
    -17.215153125,
    -17.215153125,
    -18.13235390625,
    -17.6384765625,
    -18.1088359375,
    -16.81534765625,
    -18.46160546875,
    -17.99124609375,
    -17.85013828125,
    -16.25091640625,
    -18.08531796875,
    -17.47385078125,
    -18.1088359375,
    -17.14459921875,
    -18.0147640625,
    -17.779584375,
    -18.344015625,
    -17.23867109375,
    -17.66199453125,
    -17.8266203125,
    -18.155871875,
    -17.49736875,
    -17.94421015625,
    -16.48609609375,
    -17.4503328125,
    -17.23867109375,
    -17.5444046875,
    -16.8859015625,
    -17.28570703125,
    -16.90941953125,
    -18.155871875,
    -17.6855125,
    -17.12108125,
    -17.47385078125,
    -17.89717421875,
    -17.70903046875,
    -17.85013828125,
    -17.19163515625,
    -17.779584375,
    -17.027009375,
    -17.309225,
    -17.4503328125,
    -17.49736875,
    -16.58016796875,
    -17.52088671875,
    -16.81534765625,
    -18.344015625,
    -17.4503328125,
    -17.967728125,
    -17.37977890625,
    -18.720303125,
    -17.85013828125,
    -17.591440625,
    -17.47385078125,
    -18.908446875,
    -17.89717421875,
    -17.9206921875,
    -17.2621890625,
    -18.2969796875,
    -17.37977890625,
    -17.8266203125,
    -17.37977890625,
    -18.03828203125,
    -17.967728125,
    -18.24994375,
    -17.66199453125,
    -18.13235390625,
    -17.87365625,
    -17.99124609375,
    -17.52088671875,
    -18.13235390625,
    -18.36753359375,
    -18.41456953125,
    -17.61495859375,
    -18.3910515625,
    -17.6855125,
    -18.22642578125,
    -17.52088671875,
    -17.967728125,
    -17.47385078125,
    -18.46160546875,
    -17.99124609375,
    -18.344015625,
    -17.87365625,
    -18.27346171875,
    -18.0147640625,
    -18.64974921875,
    -17.7325484375,
    -17.70903046875,
    -17.37977890625,
    -18.1088359375,
    -17.52088671875,
    -17.5444046875,
    -17.309225,
    -18.03828203125,
    -17.591440625,
    -18.32049765625,
    -17.70903046875,
    -18.08531796875,
    -18.0147640625,
    -18.1088359375,
    -17.75606640625,
    -18.2969796875,
    -17.7325484375,
    -18.0147640625,
    -17.8266203125,
    -18.13235390625,
    -17.6855125,
    -18.2969796875,
    -17.52088671875,
    -18.24994375,
    -17.591440625,
    -17.87365625,
    -17.23867109375,
    -17.85013828125,
    -17.426814843749998,
    -17.87365625,
    -17.2621890625,
    -18.22642578125,
    -18.0147640625,
    -17.99124609375,
    -17.027009375,
    -17.591440625,
    -16.81534765625,
    -17.2621890625,
    -16.67423984375,
    -17.591440625,
    -17.309225,
    -17.779584375,
    -17.426814843749998,
    -17.87365625,
    -17.28570703125,
    -17.85013828125,
    -17.4503328125,
    -17.75606640625,
    -17.33274296875,
    -17.33274296875,
    -16.81534765625,
    -17.23867109375,
    -16.25091640625,
    -17.09756328125,
    -16.838865625,
    -17.5444046875,
    -17.37977890625,
    -17.591440625,
    -17.14459921875,
    -17.6855125,
    -17.426814843749998,
    -17.87365625,
    -17.19163515625,
    -17.3562609375,
    -17.09756328125,
    -17.4503328125,
    -17.09756328125,
    -17.56792265625,
    -17.0740453125,
    -17.6855125,
    -17.309225,
    -18.0147640625,
    -17.70903046875,
    -18.061799999999998,
    -17.80310234375,
    -18.17938984375,
    -17.6855125,
    -17.89717421875,
    -17.14459921875,
    -17.75606640625,
    -17.12108125,
    -17.94421015625,
    -17.61495859375,
    -18.08531796875,
    -17.52088671875,
    -17.591440625,
    -16.9799734375,
    -17.66199453125,
    -17.52088671875,
    -17.75606640625,
    -17.37977890625,
    -18.155871875,
    -17.66199453125,
    -17.967728125,
    -17.00349140625,
    -18.13235390625,
    -17.403296875,
    -17.967728125,
    -17.426814843749998,
    -17.85013828125,
    -17.403296875,
    -17.85013828125,
    -17.5444046875,
    -18.13235390625,
    -17.426814843749998,
    -17.7325484375,
    -17.215153125,
    -17.967728125,
    -17.426814843749998,
    -17.75606640625,
    -17.09756328125,
    -17.779584375,
    -17.56792265625,
    -17.8266203125,
    -17.33274296875,
    -17.80310234375,
    -17.49736875,
    -17.80310234375,
    -17.33274296875,
    -17.94421015625,
    -17.12108125,
    -17.5444046875,
    -17.027009375,
    -17.7325484375,
    -17.2621890625,
    -17.779584375,
    -16.9799734375,
    -17.94421015625,
    -17.66199453125,
    -17.8266203125,
    -17.28570703125,
    -17.7325484375,
    -17.591440625,
    -17.8266203125,
    -17.12108125,
    -17.99124609375,
    -17.2621890625,
    -17.56792265625,
    -17.23867109375,
    -17.8266203125,
    -17.75606640625,
    -18.17938984375,
    -17.49736875,
    -17.7325484375,
    -17.309225,
    -17.66199453125,
    -17.5444046875,
    -18.1088359375,
    -17.80310234375,
    -17.87365625,
    -17.23867109375,
    -17.9206921875,
    -17.28570703125,
    -17.6855125,
    -17.05052734375,
    -17.9206921875,
    -17.1681171875,
    -17.779584375,
    -17.19163515625,
    -17.967728125,
    -17.4503328125,
    -17.426814843749998,
    -16.791829687499998,
    -17.47385078125,
    -17.1681171875,
    -17.8266203125,
    -17.33274296875,
    -17.9206921875,
    -17.591440625,
    -17.89717421875,
    -17.14459921875,
    -17.9206921875,
    -17.403296875,
    -18.0147640625,
    -17.5444046875,
    -18.1088359375,
    -17.75606640625,
    -17.75606640625,
    -17.28570703125,
    -17.89717421875,
    -17.309225,
    -17.591440625,
    -17.00349140625,
    -17.70903046875,
    -17.3562609375,
    -17.591440625,
    -17.47385078125,
    -18.2969796875,
    -17.66199453125,
    -17.7325484375,
    -17.19163515625,
    -17.7325484375,
    -17.4503328125,
    -17.87365625,
    -17.47385078125,
    -17.967728125,
    -17.12108125,
    -17.403296875,
    -16.8859015625,
    -17.99124609375,
    -17.61495859375,
    -17.37977890625,
    -17.2621890625,
    -17.591440625,
    -17.56792265625,
    -18.0147640625,
    -17.49736875,
    -17.779584375,
    -17.14459921875,
    -17.70903046875,
    -17.09756328125,
    -17.6384765625,
    -17.56792265625,
    -18.0147640625,
    -17.6855125,
    -18.17938984375,
    -17.7325484375,
    -17.87365625,
    -17.3562609375,
    -17.75606640625,
    -17.19163515625,
    -17.87365625,
    -17.33274296875,
    -18.061799999999998,
    -17.66199453125,
    -17.779584375,
    -17.28570703125,
    -17.94421015625,
    -17.309225,
    -17.87365625,
    -17.19163515625,
    -17.6384765625,
    -17.19163515625,
    -17.66199453125,
    -17.4503328125,
    -17.967728125,
    -17.2621890625,
    -17.4503328125,
    -17.1681171875,
    -17.66199453125,
    -17.3562609375,
    -18.0147640625,
    -17.309225,
    -17.94421015625,
    -17.49736875,
    -17.99124609375,
    -17.4503328125,
    -17.70903046875,
    -17.12108125,
    -17.426814843749998,
    -17.09756328125,
    -17.403296875,
    -17.05052734375,
    -17.33274296875,
    -17.0740453125,
    -17.7325484375,
    -17.426814843749998,
    -17.52088671875,
    -16.81534765625,
    -17.6384765625,
    -17.591440625,
    -17.7325484375,
    -16.95645546875,
    -17.56792265625,
    -17.37977890625,
    -17.75606640625,
    -17.19163515625,
    -17.8266203125,
    -17.52088671875,
    -17.33274296875,
    -17.0740453125,
    -17.5444046875,
    -17.215153125,
    -17.52088671875,
    -17.05052734375,
    -17.3562609375,
    -17.09756328125,
    -17.6384765625,
    -17.52088671875,
    -17.779584375,
    -17.2621890625,
    -17.70903046875,
    -17.426814843749998,
    -17.75606640625,
    -17.1681171875,
    -17.28570703125,
    -16.67423984375,
    -17.6384765625,
    -17.23867109375,
    -17.61495859375,
    -16.95645546875,
    -17.7325484375,
    -17.1681171875,
    -17.7325484375,
    -17.00349140625,
    -17.8266203125,
    -17.33274296875,
    -17.70903046875,
    -17.23867109375,
    -18.155871875,
    -17.52088671875,
    -17.779584375,
    -17.23867109375,
    -17.8266203125,
    -17.4503328125,
    -17.6384765625,
    -17.37977890625,
    -17.66199453125,
    -17.309225,
    -17.61495859375,
    -17.33274296875,
    -17.94421015625,
    -17.56792265625,
    -17.6855125,
    -17.2621890625,
    -17.33274296875,
    -17.2621890625,
    -17.49736875,
    -17.1681171875,
    -17.5444046875,
    -17.0740453125,
    -17.56792265625,
    -17.09756328125,
    -17.70903046875,
    -17.403296875,
    -17.94421015625,
    -17.52088671875,
    -18.17938984375,
    -17.80310234375,
    -18.061799999999998,
    -17.56792265625,
    -18.24994375,
    -17.779584375,
    -18.62623125,
    -18.155871875,
    -18.55567734375,
    -17.85013828125,
    -18.0147640625,
    -17.70903046875,
    -18.60271328125,
    -17.94421015625,
    -18.55567734375,
    -17.80310234375,
    -18.41456953125,
    -18.03828203125,
    -18.22642578125,
    -18.0147640625,
    -18.64974921875,
    -18.24994375,
    -18.55567734375,
    -17.85013828125,
    -18.60271328125,
    -17.94421015625,
    -18.3910515625,
    -17.75606640625,
    -18.2969796875,
    -17.967728125,
    -18.46160546875,
    -17.779584375,
    -18.438087499999998,
    -17.779584375
  ]

  def render(assigns) do
    ~L"""
      <h3>Simple Spectrum Plot Example</h3>
      <div class="container">
        <div class="row">
          <div class="column column-25">
            <form phx-change="chart_options_changed">
              <label for="show_legend">Custom X Scale</label>
              <%= raw_select("custom_x_scale", "custom_x_scale", yes_no_options(), @chart_options.custom_x_scale) %>

              <label for="show_legend">Custom Y Scale</label>
              <%= raw_select("custom_y_scale", "custom_y_scale", yes_no_options(), @chart_options.custom_y_scale) %>

              <label for="show_legend">Custom Y Ticks</label>
              <%= raw_select("custom_y_ticks", "custom_y_ticks", yes_no_options(), @chart_options.custom_y_ticks) %>

            </form>
          </div>

          <div class="column">
            <%= build_pointplot(@test_data, @chart_options) %>
            <%= list_to_comma_string(@chart_options[:friendly_message]) %>
          </div>
        </div>
      </div>
    """
  end

  def mount(_params, _session, socket) do
    socket =
      socket
      |> assign(
        chart_options: %{
          series: 3,
          points: 1025,
          title: "Spectrum Plot",
          type: "line",
          smoothed: "no",
          colour_scheme: "default",
          show_legend: "yes",
          custom_x_scale: "no",
          custom_y_scale: "no",
          custom_y_ticks: "no",
          time_series: "no"
        }
      )
      |> assign(prev_series: 0, prev_points: 0, prev_time_series: nil)
      |> make_test_data()

    {:ok, socket}
  end

  def handle_event("chart_options_changed", %{} = params, socket) do
    socket =
      socket
      |> update_chart_options_from_params(params)
      |> make_test_data()

    {:noreply, socket}
  end

  def build_pointplot(dataset, chart_options) do
    y_tick_formatter =
      case chart_options.custom_y_ticks do
        "yes" -> &custom_axis_formatter/1
        _ -> nil
      end

    module =
      case chart_options.type do
        "line" -> LinePlot
        _ -> PointPlot
      end

    custom_x_scale = make_custom_x_scale(chart_options)
    custom_y_scale = make_custom_y_scale(chart_options)

    options = [
      mapping: %{x_col: "X", y_cols: chart_options.series_columns},
      colour_palette: lookup_colours(chart_options.colour_scheme),
      custom_x_scale: custom_x_scale,
      custom_y_scale: custom_y_scale,
      custom_y_formatter: y_tick_formatter,
      smoothed: chart_options.smoothed == "yes"
    ]

    plot_options =
      case chart_options.show_legend do
        "yes" -> %{legend_setting: :legend_right}
        _ -> %{}
      end

    plot =
      Plot.new(dataset, module, 600, 400, options)
      |> Plot.titles(chart_options.title, nil)
      |> Plot.plot_options(plot_options)

    Plot.to_svg(plot)
  end

  defp make_test_data(socket) do
    options = socket.assigns.chart_options
    time_series = options.time_series == "yes"
    prev_series = socket.assigns.prev_series
    prev_points = socket.assigns.prev_points
    prev_time_series = socket.assigns.prev_time_series
    series = options.series
    points = options.points

    needs_update =
      prev_series != series or prev_points != points or prev_time_series != time_series

    data = Enum.zip([Enum.to_list(1..1025), @cur_points, @max_points, @min_points])

    series_cols = ["Live", "Min", "Max"]

    test_data =
      case needs_update do
        true -> Dataset.new(data, ["X" | series_cols])
        _ -> socket.assigns.test_data
      end

    options = Map.put(options, :series_columns, series_cols)

    assign(socket,
      test_data: test_data,
      chart_options: options,
      prev_series: series,
      prev_points: points,
      prev_time_series: time_series
    )
  end

  @date_min ~N{2019-10-01 10:00:00}
  @interval_seconds 600

  def custom_axis_formatter(value) when is_float(value) do
    "V #{:erlang.float_to_binary(value / 1_000.0, decimals: 2)}K"
  end

  def custom_axis_formatter(value) do
    "V #{value}"
  end

  defp make_custom_x_scale(%{custom_x_scale: x} = _chart_options) when x != "yes", do: nil

  defp make_custom_x_scale(chart_options) do
    points = chart_options.points

    case chart_options.time_series == "yes" do
      true ->
        Contex.TimeScale.new()
        |> Contex.TimeScale.domain(
          @date_min,
          NaiveDateTime.add(@date_min, trunc(points * 1.2 * @interval_seconds))
        )

      _ ->
        Contex.ContinuousLinearScale.new()
        |> Contex.ContinuousLinearScale.domain(0, 100)
        |> Contex.ContinuousLinearScale.interval_count(20)
    end
  end

  defp make_custom_y_scale(%{custom_y_scale: x} = _chart_options) when x != "yes", do: nil

  defp make_custom_y_scale(_chart_options) do
    Contex.ContinuousLinearScale.new()
    |> Contex.ContinuousLinearScale.domain(0, 100)
    |> Contex.ContinuousLinearScale.interval_count(20)
  end
end
